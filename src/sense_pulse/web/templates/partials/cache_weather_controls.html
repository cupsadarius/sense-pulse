<div class="space-y-4">
    <!-- Cache TTL Setting -->
    <div class="p-3 bg-gray-800/50 rounded-lg">
        <div class="flex items-center justify-between mb-2">
            <div>
                <p class="font-medium">Cache TTL</p>
                <p class="text-sm text-gray-400">How long to keep cached data (seconds)</p>
            </div>
            <input type="number" id="cache-ttl-input"
                   value="{{ config.cache.ttl }}"
                   min="10" max="600" step="10"
                   class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-1 text-sm w-20 text-right">
        </div>
        <button onclick="window.updateCacheTTL()"
                class="w-full bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 px-3 py-2 rounded-lg text-sm transition-colors border border-blue-500/50">
            Apply (requires restart)
        </button>
    </div>

    <!-- Cache Poll Interval Setting -->
    <div class="p-3 bg-gray-800/50 rounded-lg">
        <div class="flex items-center justify-between mb-2">
            <div>
                <p class="font-medium">Poll Interval</p>
                <p class="text-sm text-gray-400">How often to update data (seconds)</p>
            </div>
            <input type="number" id="cache-poll-input"
                   value="{{ config.cache.poll_interval }}"
                   min="5" max="300" step="5"
                   class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-1 text-sm w-20 text-right">
        </div>
        <button onclick="window.updateCachePoll()"
                class="w-full bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 px-3 py-2 rounded-lg text-sm transition-colors border border-blue-500/50">
            Apply (requires restart)
        </button>
    </div>

    <!-- Weather Enabled Toggle -->
    <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg">
        <div>
            <p class="font-medium">Weather Widget</p>
            <p class="text-sm text-gray-400">Show weather information</p>
        </div>
        <button id="toggle-weather"
                onclick="window.toggleWeather()"
                class="relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                       {% if config.weather.enabled %}bg-green-500{% else %}bg-gray-600{% endif %}">
            <span id="toggle-weather-slider" class="inline-block h-4 w-4 transform rounded-full bg-white transition
                         {% if config.weather.enabled %}translate-x-6{% else %}translate-x-1{% endif %}"></span>
        </button>
    </div>

    <!-- Weather Location Setting -->
    <div class="p-3 bg-gray-800/50 rounded-lg">
        <div class="mb-2">
            <p class="font-medium">Weather Location</p>
            <p class="text-sm text-gray-400 mb-2">City name or coordinates</p>
            <input type="text" id="weather-location-input"
                   value="{{ config.weather.location }}"
                   placeholder="e.g. London, New York, ~Eiffel+Tower"
                   class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm">
        </div>
        <button onclick="window.updateWeatherLocation()"
                class="w-full bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 px-3 py-2 rounded-lg text-sm transition-colors border border-cyan-500/50">
            Update (requires restart)
        </button>
    </div>
</div>

<script>
// Cache TTL update
window.updateCacheTTL = async function() {
    const ttl = parseFloat(document.getElementById('cache-ttl-input').value);
    if (ttl < 10 || ttl > 600) {
        alert('Cache TTL must be between 10 and 600 seconds');
        return;
    }

    const response = await fetch('/api/config', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cache: { ttl: ttl } })
    });

    const data = await response.json();
    if (data.status === 'success') {
        alert('Cache TTL updated. Please restart the application.');
    } else {
        alert('Error updating cache TTL: ' + data.message);
    }
};

// Cache Poll Interval update
window.updateCachePoll = async function() {
    const poll = parseFloat(document.getElementById('cache-poll-input').value);
    if (poll < 5 || poll > 300) {
        alert('Poll interval must be between 5 and 300 seconds');
        return;
    }

    const response = await fetch('/api/config', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cache: { poll_interval: poll } })
    });

    const data = await response.json();
    if (data.status === 'success') {
        alert('Poll interval updated. Please restart the application.');
    } else {
        alert('Error updating poll interval: ' + data.message);
    }
};

// Weather enabled toggle
window.toggleWeather = async function() {
    const toggle = document.getElementById('toggle-weather');
    const slider = document.getElementById('toggle-weather-slider');
    const currentState = toggle.classList.contains('bg-green-500');
    const newState = !currentState;

    const response = await fetch('/api/config', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ weather: { enabled: newState } })
    });

    const data = await response.json();
    if (data.status === 'success') {
        // Update UI
        if (newState) {
            toggle.classList.remove('bg-gray-600');
            toggle.classList.add('bg-green-500');
            slider.classList.remove('translate-x-1');
            slider.classList.add('translate-x-6');
        } else {
            toggle.classList.remove('bg-green-500');
            toggle.classList.add('bg-gray-600');
            slider.classList.remove('translate-x-6');
            slider.classList.add('translate-x-1');
        }
        alert('Weather widget ' + (newState ? 'enabled' : 'disabled') + '. Please restart the application.');
    } else {
        alert('Error toggling weather: ' + data.message);
    }
};

// Weather location update
window.updateWeatherLocation = async function() {
    const location = document.getElementById('weather-location-input').value;
    if (!location.trim()) {
        alert('Please enter a location');
        return;
    }

    const response = await fetch('/api/config', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ weather: { location: location } })
    });

    const data = await response.json();
    if (data.status === 'success') {
        alert('Weather location updated. Please restart the application.');
    } else {
        alert('Error updating weather location: ' + data.message);
    }
};
</script>
